<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Static Shock: The Electron Heist</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #12121c;
            --panel: #1e1e2f;
            --neon-pink: #ff00ff;
            --neon-cyan: #00ffff;
            --proton: #ff3333;
            --electron: #00ffff;
            --text: #ffffff;
        }

        body {
            margin: 0;
            padding: 0;
            background: var(--bg);
            color: var(--text);
            font-family: 'Roboto', sans-serif;
            overflow: hidden;
            user-select: none;
        }

        /* Animations */
        @keyframes pulse-cyan {
            0% {
                box-shadow: 0 0 5px var(--neon-cyan);
            }

            50% {
                box-shadow: 0 0 20px var(--neon-cyan);
            }

            100% {
                box-shadow: 0 0 5px var(--neon-cyan);
            }
        }

        @keyframes float {
            0% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-5px);
            }

            100% {
                transform: translateY(0px);
            }
        }

        .neon-text {
            font-family: 'Orbitron', sans-serif;
            text-shadow: 0 0 10px currentColor;
        }

        .workbench {
            position: relative;
            overflow: hidden;
            background: radial-gradient(circle at center, #2a2a40 0%, #12121c 100%);
            cursor: crosshair;
            border-radius: 12px;
            border: 1px solid #333;
            box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.5);
        }

        .object {
            position: absolute;
            border-radius: 8px;
            transition: transform 0.1s;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            padding: 5px;
        }

        .rod {
            width: 40px;
            height: 300px;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(90deg, #555, #777, #555);
            border: 2px solid #888;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }

        .cloth {
            width: 120px;
            height: 120px;
            background: url('data:image/svg+xml;utf8,<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg"><circle cx="2" cy="2" r="2" fill="%23ffffff33"/></svg>') repeat, #a855f7;
            border: 2px solid #d8b4fe;
            border-radius: 15px;
            z-index: 20;
            cursor: grab;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0.9;
        }

        .cloth:active {
            cursor: grabbing;
            transform: scale(0.95);
        }

        .particle {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            position: absolute;
            font-size: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: white;
            pointer-events: none;
        }

        .proton {
            background: var(--proton);
            box-shadow: 0 0 5px var(--proton);
            z-index: 11;
        }

        .electron {
            background: var(--electron);
            box-shadow: 0 0 5px var(--electron);
            z-index: 12;
            transition: all 0.3s ease-out;
        }

        .electron.moving {
            z-index: 30;
            width: 14px;
            height: 14px;
        }

        /* Custom Scrollbar for Theory Panel */
        .theory-scroll::-webkit-scrollbar {
            width: 8px;
        }

        .theory-scroll::-webkit-scrollbar-track {
            background: #1a1a25;
        }

        .theory-scroll::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }

        .theory-scroll::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Theory Content Data ---
        const THEORY_PAGES = [
            {
                title: "Atomic Structure",
                content: (
                    <div className="space-y-4">
                        <p>Everything in the universe is made of <strong>atoms</strong>. Atoms have three main parts:</p>
                        <ul className="list-disc pl-5 space-y-2 text-gray-300">
                            <li><strong className="text-red-400">Protons (+)</strong>: Positively charged, stuck in the center (screen). They NEVER move in static electricity.</li>
                            <li><strong className="text-cyan-400">Electrons (-)</strong>: Negatively charged, orbit the outside. They are light and CAN move freely.</li>
                            <li><strong>Neutrons (0)</strong>: Neutral, also in the center.</li>
                        </ul>
                        <div className="bg-gray-800 p-3 rounded border border-gray-600">
                            <span className="text-yellow-400 font-bold">KEY FACT:</span> A neutral object has an <strong>EQUAL</strong> number of Protons and Electrons.
                        </div>
                    </div>
                )
            },
            {
                title: "Charging by Friction",
                content: (
                    <div className="space-y-4">
                        <p>When you rub two insulating materials together (like a plastic rod and a cloth), <strong>friction</strong> creates energy.</p>
                        <p>This energy rips <strong>Electrons</strong> off one material and moves them to the other.</p>
                        <ul className="list-disc pl-5 space-y-2 text-gray-300">
                            <li>The material that <strong>GAINS</strong> electrons becomes <strong className="text-cyan-400">NEGATIVE (-)</strong>.</li>
                            <li>The material that <strong>LOSES</strong> electrons becomes <strong className="text-red-400">POSITIVE (+)</strong>.</li>
                        </ul>
                        <p className="text-sm italic text-gray-400">Note: The protons never move! Only electrons transfer.</p>
                    </div>
                )
            },
            {
                title: "Laws of Attraction",
                content: (
                    <div className="space-y-4">
                        <p>Charged objects apply forces to each other:</p>
                        <div className="grid grid-cols-2 gap-2 text-center text-sm font-bold">
                            <div className="p-2 border border-red-500 rounded bg-red-900/20">Like Charges REPEL (+ and +)</div>
                            <div className="p-2 border border-green-500 rounded bg-green-900/20">Opposites ATTRACT (+ and -)</div>
                        </div>
                        <p>A neutral object is also attracted to charged objects due to <em>induction</em>.</p>
                    </div>
                )
            }
        ];

        // --- Game Data ---
        const LEVELS = [
            {
                id: 1,
                goal: "Make the Rod NEGATIVE",
                rodMaterial: "Polythene Rod",
                clothMaterial: "Wool Cloth",
                rodAffinity: 2, // Rod takes electrons
                targetCharge: "negative",
                hint: "Polythene is an electrical thief! Rub it to steal electrons from the wool."
            },
            {
                id: 2,
                goal: "Make the Rod POSITIVE",
                rodMaterial: "Acetate Rod",
                clothMaterial: "Cotton Cloth",
                rodAffinity: 0, // Rod gives electrons
                targetCharge: "positive",
                hint: "Acetate is weak! Rub it so the cloth steals its electrons."
            },
            {
                id: 3,
                goal: "Discharge the Rod",
                rodMaterial: "Charged Metal",
                clothMaterial: "Ground Wire",
                rodAffinity: 1,
                targetCharge: "neutral",
                preCharge: -5,
                hint: "The rod has too many electrons! Touch it to let them escape to the ground."
            }
        ];

        const PARTICLE_COUNT = 16;

        const Particle = ({ type, x, y, isMoving }) => {
            const className = `particle ${type === 'p' ? 'proton' : 'electron'} ${isMoving ? 'moving' : ''}`;
            return <div className={className} style={{ left: x, top: y }}>{type === 'p' ? '+' : '-'}</div>;
        };

        const App = () => {
            const [view, setView] = useState('split'); // 'split' (desktop), 'theory', 'sim' (mobile)
            const [levelIdx, setLevelIdx] = useState(0);
            const [gameState, setGameState] = useState('playing');
            const [rodCharge, setRodCharge] = useState(0);
            const [electrons, setElectrons] = useState([]);
            const [protons, setProtons] = useState([]);
            const [clothPos, setClothPos] = useState({ x: 50, y: 150 }); // Relative to workbench
            const [isDragging, setIsDragging] = useState(false);
            const [feedbackMsg, setFeedbackMsg] = useState('');

            const workbenchRef = useRef(null);
            const level = LEVELS[levelIdx];

            // --- Simulation Logic ---
            useEffect(() => {
                const newEs = [];
                const newPs = [];

                const initParticles = (owner, count, offsetX, offsetY, w, h) => {
                    for (let i = 0; i < count; i++) {
                        const rx = Math.random() * w;
                        const ry = Math.random() * h;
                        const id = Math.random().toString(36);
                        newPs.push({ id: `p-${id}`, type: 'p', owner, relX: rx, relY: ry });

                        const eCount = (level.preCharge && owner === 'rod') ? count + Math.abs(level.preCharge) : count;
                        if (i < eCount) {
                            newEs.push({ id: `e-${id}`, type: 'e', owner, relX: rx, relY: ry });
                        }
                    }
                };

                initParticles('rod', PARTICLE_COUNT, 0, 0, 40, 300);
                initParticles('cloth', PARTICLE_COUNT, 0, 0, 100, 100);

                setProtons(newPs);
                setElectrons(newEs);
                setRodCharge(level.preCharge || 0);
                setGameState('playing');
                setFeedbackMsg('');
                setClothPos({ x: 50, y: 200 });
            }, [levelIdx]);

            const getRenderPos = (p) => {
                // Container is responsive, but rod is fixed center relative to container
                if (!workbenchRef.current) return { x: 0, y: 0 };
                const rect = workbenchRef.current.getBoundingClientRect();

                if (p.owner === 'rod') {
                    // Center of container
                    const rodX = (rect.width / 2) - 20;
                    const rodY = (rect.height / 2) - 150;
                    return { x: rodX + p.relX, y: rodY + p.relY };
                } else {
                    // Cloth tracks mouse/touch state
                    return { x: clothPos.x - 60 + p.relX, y: clothPos.y - 60 + p.relY };
                }
            };

            const handleMove = (clientX, clientY) => {
                if (!workbenchRef.current) return;
                const rect = workbenchRef.current.getBoundingClientRect();
                const x = clientX - rect.left;
                const y = clientY - rect.top;

                // Constrain to container
                const clampedX = Math.max(0, Math.min(x, rect.width));
                const clampedY = Math.max(0, Math.min(y, rect.height));

                setClothPos({ x: clampedX, y: clampedY });

                // Collision Logic
                const rodCenterX = rect.width / 2;
                const rodCenterY = rect.height / 2;

                if (Math.abs(clampedX - rodCenterX) < 60 && Math.abs(clampedY - rodCenterY) < 160) {
                    if (Math.random() > 0.8) transferElectron();
                }
            };

            const transferElectron = () => {
                setElectrons(prev => {
                    let source = '';
                    if (level.rodAffinity === 2) source = 'cloth';
                    else if (level.rodAffinity === 0) source = 'rod';
                    else if (level.preCharge !== 0) source = level.preCharge < 0 ? 'rod' : 'cloth';

                    if (!source) return prev;
                    const candidateIdx = prev.findIndex(e => e.owner === source);
                    if (candidateIdx === -1) return prev;

                    const newArr = [...prev];
                    const moved = { ...newArr[candidateIdx] };
                    moved.owner = source === 'cloth' ? 'rod' : 'cloth';

                    if (moved.owner === 'rod') {
                        moved.relX = Math.random() * 40;
                        moved.relY = Math.random() * 300;
                    } else {
                        moved.relX = Math.random() * 100;
                        moved.relY = Math.random() * 100;
                    }
                    newArr[candidateIdx] = moved;

                    const rodEs = newArr.filter(e => e.owner === 'rod').length;
                    setRodCharge(PARTICLE_COUNT - rodEs);
                    return newArr;
                });
            };

            const checkAnswer = (guess) => {
                let isCorrect = false;
                if (level.targetCharge === 'negative' && rodCharge < -2 && guess === 'negative') isCorrect = true;
                if (level.targetCharge === 'positive' && rodCharge > 2 && guess === 'positive') isCorrect = true;
                if (level.targetCharge === 'neutral' && Math.abs(rodCharge) < 2 && guess === 'neutral') isCorrect = true;

                if (isCorrect) {
                    setGameState('won');
                    setFeedbackMsg("CORRECT! You mastered the electrons.");
                } else {
                    setFeedbackMsg("Review the theory! Check the particle balance.");
                }
            };

            // --- UI Render ---
            return (
                <div className="flex flex-col h-screen overflow-hidden bg-[#12121c]">
                    {/* Header */}
                    <header className="flex justify-between items-center p-4 border-b border-gray-800 bg-[#1a1a25] shrink-0">
                        <h1 className="text-xl md:text-2xl font-bold neon-text text-white tracking-widest">
                            STATIC <span className="text-cyan-400">SHOCK</span>
                        </h1>
                        <div className="flex gap-2 text-sm font-mono">
                            <span className="bg-gray-800 px-3 py-1 rounded text-gray-400">Level {levelIdx + 1}/3</span>
                            <span className="hidden md:inline-block bg-gray-800 px-3 py-1 rounded text-cyan-400 border border-cyan-500/30">Grade 9 Physics</span>
                        </div>
                    </header>

                    {/* Mobile Toggle */}
                    <div className="md:hidden flex border-b border-gray-800 bg-[#1a1a25]">
                        <button onClick={() => setView('theory')} className={`flex-1 py-3 font-bold ${view === 'theory' ? 'text-cyan-400 border-b-2 border-cyan-400' : 'text-gray-500'}`}>THEORY</button>
                        <button onClick={() => setView('sim')} className={`flex-1 py-3 font-bold ${view === 'sim' ? 'text-cyan-400 border-b-2 border-cyan-400' : 'text-gray-500'}`}>LAB</button>
                    </div>

                    <div className="flex flex-1 overflow-hidden relative">

                        {/* LEFT PANEL: THEORY */}
                        <div className={`w-full md:w-1/3 bg-[#161621] border-r border-gray-800 z-10 flex flex-col theory-scroll overflow-y-auto ${view === 'sim' ? 'hidden md:flex' : 'flex'}`}>
                            <div className="p-6 space-y-8">
                                {THEORY_PAGES.map((page, i) => (
                                    <section key={i} className="animate-fade-in">
                                        <h2 className="text-lg font-bold text-pink-500 mb-3 border-b border-gray-700 pb-2 flex items-center gap-2">
                                            <span className="bg-pink-900/50 w-6 h-6 rounded-full flex items-center justify-center text-xs border border-pink-500">{i + 1}</span>
                                            {page.title}
                                        </h2>
                                        <div className="text-gray-300 leading-relaxed text-sm">
                                            {page.content}
                                        </div>
                                    </section>
                                ))}

                                <div className="bg-blue-900/20 p-4 rounded-lg border border-blue-500/30 mt-8">
                                    <h3 className="text-blue-400 font-bold mb-2">Current Mission</h3>
                                    <p className="text-white mb-2">{level.goal}</p>
                                    <p className="text-sm text-gray-400 italic">"{level.hint}"</p>
                                </div>
                            </div>
                        </div>

                        {/* RIGHT PANEL: SIMULATION */}
                        <div className={`w-full md:w-2/3 flex flex-col relative bg-black ${view === 'theory' ? 'hidden md:flex' : 'flex'}`}>

                            {/* Workbench Area */}
                            <div
                                ref={workbenchRef}
                                className="flex-1 workbench m-4"
                                onMouseMove={(e) => isDragging && handleMove(e.clientX, e.clientY)}
                                onTouchMove={(e) => handleMove(e.touches[0].clientX, e.touches[0].clientY)}
                                onMouseDown={() => setIsDragging(true)}
                                onMouseUp={() => setIsDragging(false)}
                                onTouchStart={() => setIsDragging(true)}
                                onTouchEnd={() => setIsDragging(false)}
                            >
                                {/* Rod */}
                                <div className="object rod"></div>

                                {/* Cloth */}
                                <div
                                    className="object cloth"
                                    style={{ left: clothPos.x, top: clothPos.y, transform: 'translate(-50%, -50%)' }}
                                >
                                    <span className="text-[10px] font-bold text-white pointer-events-none">{level.clothMaterial}</span>
                                </div>

                                {/* Particles */}
                                {protons.map(p => {
                                    const pos = getRenderPos(p);
                                    return <Particle key={p.id} type="p" x={pos.x} y={pos.y} />;
                                })}
                                {electrons.map(e => {
                                    const pos = getRenderPos(e);
                                    return <Particle key={e.id} type="e" x={pos.x} y={pos.y} isMoving={isDragging} />;
                                })}

                                {/* Charge Indicator */}
                                <div className="absolute right-4 top-1/2 -translate-y-1/2 bg-gray-900/80 p-3 rounded border border-gray-600 backdrop-blur pointer-events-none">
                                    <div className="text-xs text-gray-400 uppercase tracking-widest mb-1">Net Charge</div>
                                    <div className={`text-2xl font-bold ${rodCharge > 0 ? 'text-red-500' : rodCharge < 0 ? 'text-cyan-400' : 'text-gray-200'}`}>
                                        {rodCharge > 0 ? '+' : ''}{rodCharge}
                                    </div>
                                </div>
                            </div>

                            {/* Controls Footer inside Right Panel */}
                            <div className="bg-[#1a1a25] p-4 border-t border-gray-800 flex flex-col md:flex-row gap-4 justify-between items-center shrink-0">
                                <div className="text-sm text-gray-400 hidden md:block">
                                    Drag the cloth to rub against the rod.
                                </div>
                                <div className="flex gap-2 w-full md:w-auto">
                                    <button onClick={() => checkAnswer('positive')} className="flex-1 md:flex-none px-6 py-2 bg-transparent border border-gray-600 rounded hover:border-red-500 hover:text-red-500 transition text-sm font-bold">POSITIVE (+)</button>
                                    <button onClick={() => checkAnswer('neutral')} className="flex-1 md:flex-none px-6 py-2 bg-transparent border border-gray-600 rounded hover:border-gray-200 hover:text-white transition text-sm font-bold">NEUTRAL</button>
                                    <button onClick={() => checkAnswer('negative')} className="flex-1 md:flex-none px-6 py-2 bg-transparent border border-gray-600 rounded hover:border-cyan-500 hover:text-cyan-500 transition text-sm font-bold">NEGATIVE (-)</button>
                                </div>
                            </div>

                            {/* Feedback Overlay */}
                            {gameState === 'won' && (
                                <div className="absolute inset-0 bg-black/90 flex flex-col items-center justify-center z-50 animate-fade-in">
                                    <h2 className="text-4xl font-bold text-cyan-400 mb-2 neon-text">Mission Complete</h2>
                                    <p className="text-gray-300 mb-8">{feedbackMsg}</p>
                                    <button
                                        onClick={() => {
                                            if (levelIdx < LEVELS.length - 1) setLevelIdx(l => l + 1);
                                            else alert("You finished all levels!");
                                        }}
                                        className="px-8 py-3 bg-pink-600 text-white rounded-full font-bold hover:bg-pink-500 shadow-[0_0_20px_rgba(236,72,153,0.5)] transition"
                                    >
                                        {levelIdx < LEVELS.length - 1 ? "Next Level" : "Finish Course"}
                                    </button>
                                </div>
                            )}
                            {feedbackMsg && gameState !== 'won' && (
                                <div className="absolute bottom-24 left-1/2 -translate-x-1/2 bg-red-900/90 text-white px-6 py-2 rounded-full border border-red-500 animate-pulse">
                                    {feedbackMsg}
                                </div>
                            )}

                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>